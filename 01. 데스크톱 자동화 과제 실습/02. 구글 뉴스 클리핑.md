# 구글 뉴스 클리핑

## Task 1: PowerAutomate 주요 항목

- 왼쪽 목록은 각 카테고리 별 사용하는 기능(Action)입니다.
- 원하는 카테고리를 펼치면, 다양한 기능들이 나타납니다.
- 해당 기능을 드래그하여 흐름에 적용시킬 수 있습니다.

![스크린샷 2024-11-08 102022](https://github.com/user-attachments/assets/85f81b55-6fe8-40b1-8c25-ef2451ae3183)![스크린샷 2024-11-08 102059](https://github.com/user-attachments/assets/d9e909ad-93fa-4878-afc3-10ae1ebc290f)

- 상단의 '**하위흐름**'을 펼치면, 하위흐름 목록과 새 하위흐름을 생성할 수 있습니다.
- **하위흐름**: Power Automate Desktop은 주로 **Main흐름**과 **하위흐름**으로 구성되어 있습니다.
  <br>모든 작업을 **Main흐름**에 저장하면 그 흐름을 탐색하고 유지하기가 어려울 수 있습니다.
  <br>**하위흐름**을 통해서 각 흐름의 코드를 단축하여 관리가 용이해집니다.

![스크린샷 2024-11-08 131220](https://github.com/user-attachments/assets/b5543417-1310-42c9-8810-4ac0e51b2778)

- 우측 목록은 위에서부터 개발 하면서 등록되었던 **변수**, **UI**, **이미지**를 보여줍니다.
- **변수**: 특정 값을 저장하기 위한 이름을 가진 공간입니다. (ex. '최애음식'이라는 변수에 '소고기'를 저장)
- **UI**: 사람들이 컴퓨터와 상호 작용하는 시스템으로, 각 UI별 속성이 존재합니다. <br>
          주로 버튼이나 텍스트 박스, 로고, 메뉴 등 여러가지가 있습니다. 
- **이미지**: '**UI**'가 아닌 캡쳐를 통해 이미지를 생성하여 UI속성이 아닌, 이미지 인식을 통해 작업하는 용도입니다.

![image](https://github.com/user-attachments/assets/c27b4ed7-d967-40d6-bd7d-e1ccdf982f41)
![스크린샷 2024-11-12 165443](https://github.com/user-attachments/assets/32b1e102-d837-4209-8920-93f262624ed3)
![스크린샷 2024-11-12 165556](https://github.com/user-attachments/assets/961c829b-2e27-4dd5-b08f-6e832893d4ee)
## Task 2: 개발 흐름 설계

- **Main흐름**은 실행 시 가장 먼저 수행되는 흐름입니다.<br>
![스크린샷 2024-11-08 101425](https://github.com/user-attachments/assets/f3003a6c-32c1-4c47-8732-f167bf6e6215)

**(1) 설명**: 설명(주석)을 통해 해당 과제 또는 기능에 대해 설명이 필요한 경우 사용합니다.<br>
**(2) 변수 설정**: 프로세스에 사용할 변수를 설정 합니다.<br>
**(3) 하위 흐름 실행**: 하위 흐름을 실행합니다. 

## Task 2: 구글 뉴스 클리핑 구현

![스크린샷 2024-11-08 104757](https://github.com/user-attachments/assets/0669f597-0fd8-4478-8b59-2a33afc4f2bf)
![스크린샷 2024-11-08 151519](https://github.com/user-attachments/assets/398e42db-bf7c-4d73-abc7-f745ac1cf5db)

**(1) (새 Chrome 시작)**: 크롬으로 구글에 접속합니다.<br>
```
시작 모드: 새 인스턴스 시작
이니셜URL: https://www.google.co.kr 또는 https://www.google.com
창 상태: 최대화됨
대상 데스크톱: 로컬 컴퓨터
```
![image](https://github.com/user-attachments/assets/be6aea10-790d-4854-a678-0d93e0a454af)

**(2) (웹 페이지 콘텐츠 기다리기)**: 크롬의 '구글 로고' UI가 나올 때까지 대기합니다. (최대 15초 대기)<br>
```
웹 브라우저 인스턴스: '새 Chrome 시작'에서 생성된 인스턴스 변수 // 기본값: %Browser%
페이지 기다리기: 요소 포함
UI 요소 상태 확인: off
UI 요소: 이미지 참고
시간 제한 오류로 실패: on
기간: 15초
```
![스크린샷 2024-11-08 161039](https://github.com/user-attachments/assets/6d9c3554-cd3a-4080-9764-a78fd05cc231)<br>

- UI 요소의 목록을 클릭하여 '**UI 요소 추가**'를 클릭합니다.
- 해당 구글 로고에 커서 이동 후 '**ctrl+좌클릭**'으로 UI를 추가합니다.
- 이후 다른 UI 추가 방식 또한 동일합니다.
![image](https://github.com/user-attachments/assets/339d0751-ea89-4a12-837c-398ce6a6db63)

**(3) (웹 페이지의 텍스트 필드 채우기)**: 구글 '검색 박스' UI에 검색 키워드를 입력합니다.<br>
```
웹 브라우저 인스턴스: '새 Chrome 시작'에서 생성된 인스턴스 변수 // 기본값: %Browser%
UI 요소: 구글 검색 박스 UI
텍스트: kpop
```
![스크린샷 2024-11-08 161056](https://github.com/user-attachments/assets/167f776e-e2c9-47b3-bd55-8b0a3820fbd3)

**(4) (웹 페이지의 텍스트 필드에 포커스 설정)**: 구글 '검색 박스' UI를 포커싱 합니다.<br>
![image](https://github.com/user-attachments/assets/e68c6128-5108-4ff3-a45c-0a0dada9ae13)<br>

**(5) (키 보내기)**: (4)에서 포커싱된 검색 박스를 유지한 채 '엔터'를 입력합니다.<br>
```
키 보내기: 창 인스턴스/핸들
창 인스턴스: '새 Chrome 시작'에서 생성된 인스턴스 변수 // 기본값: %Browser%
보낼 텍스트: 특수 키 삽입 -> 기타 -> Enter 선택
```
![image](https://github.com/user-attachments/assets/6daaad96-dd88-4c9c-bad3-eebbf66839f1)

**(6) (웹 페이지 콘텐츠 기다리기)**: 크롬 좌측 상단의 '구글 로고' UI가 나올 때까지 대기합니다. (최대 15초 대기)<br>
**(7) (웹 페이지에서 링크 클릭)**: 검색 이후 '뉴스'탭을 클릭합니다.<br>
```
웹 브라우저 인스턴스: '새 Chrome 시작'에서 생성된 인스턴스 변수 // 기본값: %Browser%
UI 요소: 검색된 페이지에서의 '뉴스'탭
클릭 유형: 왼쪽 클릭
```
![스크린샷 2024-11-08 161511](https://github.com/user-attachments/assets/24ee0758-8537-4427-8ac6-76f36625ec94)

**(8) (웹 페이지에서 데이터 추출)**: 검색된 뉴스의 제목, 내용, URL(**선택사항**)들을 추출합니다.(원하는 박스에 **우클릭**하여 추출)<br>
아래의 뉴스에서도 동일한 방법으로 추출하여 나머지 데이터를 자동으로 추출합니다.
```
변수명: dt_Result
```
![image](https://github.com/user-attachments/assets/06a22535-5950-4502-91e9-368e2a7dd27d)

![image](https://github.com/user-attachments/assets/78714df9-1051-4010-8830-457fc692562d)

**(9-1) (각각의 경우)**: 뉴스 정보를 추출한 데이터테이블을 1행부터 한 행씩 차례로 반복합니다.<br>
```
각각의 행 변수명: row_Reuslt
```
![image](https://github.com/user-attachments/assets/87a8d284-250a-4773-a4ff-055e6d53e4ed)

- 추출한 데이터는 우측 변수 목록에서 해당 변수를 더블클릭하면 확인이 가능합니다.
![image](https://github.com/user-attachments/assets/cad150f3-dacc-4d06-9f2e-be50fa98b490)


**(9-2) (테이블에 행 추가)**: 한 행의 제목, 내용, URL을 Teams에 저장되어있는 엑셀파일에 데이터를 추가합니다.
```
위치: Group - MSFT
문서 라이브러리: Documents
파일: /Genereal/(USER ID)/뉴스모음.xlsx
테이블: NewsTable (엑셀 테이블의 이름입니다.)
Title: %row_Result[0]% - 작업하는 행의 인덱스 0(1번째) 열에 해당하는 값
OriginalLink: %row_Result[2]% - 작업하는 행의 인덱스 2(3번째) 인덱스 열에 해당하는 값
Description: %row_Result[1]% - 작업하는 행의 인덱스 1(2번째) 인덱스 열에 해당하는 값
변수 생성됨: off
```
![image](https://github.com/user-attachments/assets/65272cb2-5e6a-421d-a2ba-763a1b53cf4b)

- 작업 결과입니다. (Teams에서 파일 확인)
![image](https://github.com/user-attachments/assets/5e001392-3bcc-4238-9d33-45bdd94aad32)

