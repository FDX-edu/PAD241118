# 개요
1. Power Automate에서 인스턴트 클라우드 흐름을 생성하고 수동 트리거를 설정합니다.<br/>
2. 흐름에 키워드 입력 변수를 추가하여 사용자로부터 검색 키워드를 받습니다.<br/>
3. HTTP 작업을 추가하고, 네이버 뉴스 API를 호출하여 뉴스 데이터를 가져옵니다.<br/>
4. JSON 데이터를 파싱하고, For Each 반복문을 사용하여 각 뉴스 항목을 처리합니다.<br/>
5. 처리된 데이터를 Excel 테이블에 저장하고, 흐름을 테스트하여 실행을 확인합니다.<br/>
<br/><br/>
# Power Automate Cloud 흐름 생성

#### 1. Power Automate 홈페이지를 접속합니다.
```
https://make.powerautomate.com/
```
아래 사진처럼 환경이 '**MSFT**' 로 되어있는지 확인해주세요.
![슬라이드2](https://github.com/user-attachments/assets/63d9f9f9-190e-4025-a9cf-2466eb5cc96e)

#### 2. 좌측 목록에서 '**내 흐름(My flows)**'을 클릭합니다.<br/>
![슬라이드3](https://github.com/user-attachments/assets/aeea09d6-3466-4f8f-a008-1d5b8c9be374)

#### 3. 트리거를 지정하여 새 흐름을 생성합니다.
3 - 1) '**인스턴트 클라우드 흐름(Instant cloud flow)**'으로 새 흐름 생성을 준비합니다.<br/>
3 - 2) 흐름 이름을 작성합니다. <br/>
```
네이버 뉴스 클리핑
```
3 - 3) 흐름 이름 입력 후 '**수동으로 흐름 트리거(Manually trigger a flow)**'선택하고 흐름을 생성합니다.<br/><br/>
![슬라이드4](https://github.com/user-attachments/assets/ea2d1135-4f67-4dd5-8b50-b92d0af523be)

# API 사용 네이버 뉴스 클리핑
#### 1. 키워드 변수 설정
1 - 1) [수동으로 흐름 트리거] 작업액션을 클릭합니다.<br/>
1 - 2) 좌측의 상세화면에서 '**+입력추가(Add an input)**'를 클릭하여 '**keyword**'이름의 변수를 설정합니다.<br/>
![슬라이드5](https://github.com/user-attachments/assets/7298b8de-b011-4239-826b-57f288637e44)

#### 2. HTTP 작업액션 추가
2 - 1) [수동으로 흐름 트리거] 작업액션 하단의 '작업 추가'버튼을 눌러 작업 추가합니다.<br/>
2 - 2) 좌측 작업액션 목록에서 기능을 검색하여 원하는 기능을 추가할 수 있습니다..<br/>
- 검색: HTTP<br/>
- 런타임: 기본 제공<br/>
![슬라이드6](https://github.com/user-attachments/assets/0afe2913-ce6b-4af2-82ff-185efbac5224)


#### 3. HTTP 작업액션 사용
3 - 1) URL<br/>
- 네이버에서 제공하는 API의 엔드포인트를 작성합니다.<br/>
  ```
  https://openapi.naver.com/v1/search/news.json?query=검색어&display=10&start1&sort=sim
  ```
- 검색어라고 작성된 부분은 삭제해주시고, 버튼 클릭 후 검색창에 keyword라 입력할 시 나타나는 변수를 선택해주세요.<br/>
- 아래를 복사할 시, 변수 keyword 설정까지 모두 완료됩니다.<br/>
  ```
  https://openapi.naver.com/v1/search/news.json?query=@{triggerBody()?['text']}&display=10&start1&sort=sim
  ```
3 - 2) Headers<br/>
- 첫 번째 헤더 (좌측)
  ```
  X-Naver-Client-Id
  ```
- 첫 번째 헤더 (우측)
  ```
  O3tukTTYFY61gYoOrK7L
  ```

- 두 번째 헤더 (좌측)
  ```
  X-Naver-Client-Secret
  ```
- 두 번째 헤더 (우측)
  ```
  zOVnN1eTVc
  ``` 
- Json은 key와 value로 이루어져있습니다. 좌측은 key, 우측은 value에 해당하며 Json에서는 콜론(:)으로 구분하지만, Power Automate는 사용자의 편의에 맞게 해당 UI로 이루어져있습니다.<br/>
- 현재 사용하는 API에서 헤더는 네이버가 사용자를 특정하기 위해 발급한 허가 일련번호라고 이해하시면 쉽습니다.<br/>

![슬라이드7](https://github.com/user-attachments/assets/21ab3f61-2d69-46ec-a690-071c3ebe9e4b)


# 결과 활용하기

#### 1. 결과 Json을을 Parsing<br/>
<br/>
> '**Json Parsing**'<br/>
> JSON 형식으로 전달된 데이터를 프로그램에서 사용할 수 있는 형식으로 변환하는 과정<br/>
<br/>
1 - 1) [Json 구문 분석] 작업액션을 추가합니다.<br/>
- 검색: Json<br/>
- 런타임: 기본 제공<br/>

![슬라이드8](https://github.com/user-attachments/assets/490fbbc1-9a62-4110-a0ae-a20f486d7bef)

1 - 2) [Json 구문 분석] 작업액션을 클릭할 시 나타나는 상세 페이지에서 하단의 '샘플 페이로드를 사용하여 스키마 생성' 버튼을 클릭합니다.<br/>
1 - 3) 나타나는 창에 API를 사용하여 얻은 Json 데이터를 복사합니다.<br/>
- 관련 결과는 '02. 클라우드 자동화 과제실습\01.네이버API.md'를 참고해주세요.<br/>
1 - 4) '완료' 버튼을 클릭할 시, 결과가 자동 도출됩니다.<br/>
![슬라이드9](https://github.com/user-attachments/assets/21f2663e-d808-4b3f-8661-751a1aff0803)

- [Json 구문 분석] 작업액션 하단의 Schema에 하단의 Json 형태를 넣으셔도 됩니다.
  <details>
  <summary>클릭하여 내용 확인</summary>
    ```json
    {
    "type": "object",
    "properties": {
        "lastBuildDate": {
            "type": "string"
        },
        "total": {
            "type": "integer"
        },
        "start": {
            "type": "integer"
        },
        "display": {
            "type": "integer"
        },
        "items": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "title": {
                        "type": "string"
                    },
                    "originallink": {
                        "type": "string"
                    },
                    "link": {
                        "type": "string"
                    },
                    "description": {
                        "type": "string"
                    },
                    "pubDate": {
                        "type": "string"
                    }
    },
    "required": [
    "title",
    "originallink",
    "link",
    "description",
    "pubDate"
    ]
    }
    }
    }
    }
    
  </details>```

#### 2. 반복(For Each) 사용
- For each의 속성에서, 해당 칸에 Parsing한 '**body items**'를 입력합니다.
- For each는 추출된 데이터의 첫 번째 행부터, 한 행씩 반복하여 마지막 행까지 수행하는 기능입니다.

![스크린샷 2024-11-11 162623](https://github.com/user-attachments/assets/7290533e-85a8-4ae4-bbbf-28cf22f2aaf9)

#### 3. Add a row Into a table(테이블에 행 추가)
- **위치**: Teams의 Group - MSFT
- **문서 라이브러리**: Documents
- **파일**: /General/(봇ID)_뉴스모음.xlsx
- **테이블**: NewsTable [뉴스모음.xlsx의 테이블 이름입니다.]

- 해당 작업 설정 시 로그인이 필요한 경우, 로그인을 해줍니다.
![스크린샷 2024-11-12 092133](https://github.com/user-attachments/assets/b0b7c219-f4bc-4f10-bad7-788dc1e5b87d)


![스크린샷 2024-11-11 164953](https://github.com/user-attachments/assets/b216df8e-e116-428f-975d-a45f91c4a38a)

실행 준비가 되었다면 '**저장(Save)**'버튼 클릭하고 '**테스트(Test)**'를 클릭하여 '**수동(Manually)**'으로 테스트합니다.
![image](https://github.com/user-attachments/assets/9451c636-ff11-4482-aa4c-0b35897b53c2)
