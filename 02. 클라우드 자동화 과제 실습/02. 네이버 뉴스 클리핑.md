# 개요
1. Power Automate에서 인스턴트 클라우드 흐름을 생성하고 수동 트리거를 설정합니다.
2. 흐름에 키워드 입력 변수를 추가하여 사용자로부터 검색 키워드를 받습니다.
3. HTTP 작업을 추가하고, 네이버 뉴스 API를 호출하여 뉴스 데이터를 가져옵니다.
4. JSON 데이터를 파싱하고, For Each 반복문을 사용하여 각 뉴스 항목을 처리합니다.
5. 처리된 데이터를 Excel 테이블에 저장하고, 흐름을 테스트하여 실행을 확인합니다.
<br/><br/>
# Power Automate Cloud 흐름 생성

#### 1. Power Automate 홈페이지를 접속합니다.
```
https://make.powerautomate.com/
```
<br/><br/>
#### 2. 좌측 목록에서 '**내 흐름(My flows)**'을 클릭합니다.<br/>
![스크린샷 2024-11-07 105558](https://github.com/user-attachments/assets/cc37e4ed-efa3-4479-a3af-29294331e47e)
<br/><br/>
#### 3. '**인스턴트 클라우드 흐름(Instant cloud flow)**'으로 새 흐름 생성을 준비합니다.<br/><br/>
![스크린샷 2024-11-11 111652](https://github.com/user-attachments/assets/a5c763dc-b6fe-4872-9c7b-8aa5916a90a3)
<br/><br/>
#### 4. 흐름 이름 입력 후 '**수동으로 흐름 트리거(Manually trigger a flow)**'선택하고 흐름을 생성합니다.<br/><br/>
![스크린샷 2024-11-11 140604](https://github.com/user-attachments/assets/2a8c58c8-2d97-4f7a-9d0c-3aeb30c568b9)
<br/><br/><br/>

# API 사용 네이버 뉴스 클리핑
#### 1. 키워드 변수 설정
- '**+입력추가(Add an input)**'를 클릭하여 '**keyword**'이름의 변수를 설정합니다. (이름은 자유)
![스크린샷 2024-11-12 092814](https://github.com/user-attachments/assets/feff15aa-9d8d-4137-92b6-28d7ae667668)


#### 2. HTTP 작업액션 추가
- '+'버튼을 눌러 작업 추가를 합니다.
- 목록에서 기능을 검색하여 원하는 기능을 추가합니다. (우측 이미지)

![스크린샷 2024-11-11 163434](https://github.com/user-attachments/assets/8300216f-1d8c-455b-a6c3-093def8d3dca)![스크린샷 2024-11-11 163308](https://github.com/user-attachments/assets/1007c309-86d6-4253-85f4-bd468eedaa66)

네이버 뉴스 검색
- '**01. 네이버API**'에서 생성된 API를 사용합니다.
- 뉴스 검색 URI를 넣고, 이미지와 같이 키워드에 해당되는 부분에 문자를 넣습니다. (**안되시는 분만 아래 URI사용**)

```
https://openapi.naver.com/v1/search/news.json?query=키워드&display=10&start1&sort=sim
```
- '**키워드**'라고 명시되어있는 곳에 '**번개**'표시를 클릭하여, **keyword**를 추가해 줍니다.
- '**Method**'는 뉴스 결과를 가져올 예정이기에, '**GET**'으로 설정합니다.
- '**Headers**'는 제공해주는 정보의 **클라이언트ID**와 **클라이언트Secret**을 입력해줍니다.

![스크린샷 2024-11-11 152100](https://github.com/user-attachments/assets/da50b04e-23f1-45c5-a089-c440816cd7d5)

# 결과 활용하기

#### 1. 결과 Json을을 Parsing
- 클리핑 완료한 뉴스 데이터를 Json으로 Parsing하여 추출합니다.
- **Content**에는 API를 통해 추출한 뉴스데이터를 넣어줍니다. (HTTP의 '본문')
- 하단의 '**샘플 페이로드를 사용하여 스키마 생성**'을 사용하여 '**01. 네이버API**'에서 테스트했던 cmd 결과를 넣어 Schema를 자동으로 생성할 수 있습니다.

  
![스크린샷 2024-11-11 161144](https://github.com/user-attachments/assets/283fc077-9244-48f0-9397-c98117ebe571)

- 하단의 Json 형태를 넣으셔도 됩니다.

```
{
    "type": "object",
    "properties": {
        "lastBuildDate": {
            "type": "string"
        },
        "total": {
            "type": "integer"
        },
        "start": {
            "type": "integer"
        },
        "display": {
            "type": "integer"
        },
        "items": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "title": {
                        "type": "string"
                    },
                    "originallink": {
                        "type": "string"
                    },
                    "link": {
                        "type": "string"
                    },
                    "description": {
                        "type": "string"
                    },
                    "pubDate": {
                        "type": "string"
                    }
                },
                "required": [
                    "title",
                    "originallink",
                    "link",
                    "description",
                    "pubDate"
                ]
            }
        }
    }
}
```

#### 2. 반복(For Each) 사용
- For each의 속성에서, 해당 칸에 Parsing한 '**body items**'를 입력합니다.
- For each는 추출된 데이터의 첫 번째 행부터, 한 행씩 반복하여 마지막 행까지 수행하는 기능입니다.

![스크린샷 2024-11-11 162623](https://github.com/user-attachments/assets/7290533e-85a8-4ae4-bbbf-28cf22f2aaf9)

#### 3. Add a row Into a table(테이블에 행 추가)
- **위치**: Teams의 Group - MSFT
- **문서 라이브러리**: Documents
- **파일**: /General/(봇ID)_뉴스모음.xlsx
- **테이블**: NewsTable [뉴스모음.xlsx의 테이블 이름입니다.]

- 해당 작업 설정 시 로그인이 필요한 경우, 로그인을 해줍니다.
![스크린샷 2024-11-12 092133](https://github.com/user-attachments/assets/b0b7c219-f4bc-4f10-bad7-788dc1e5b87d)


![스크린샷 2024-11-11 164953](https://github.com/user-attachments/assets/b216df8e-e116-428f-975d-a45f91c4a38a)

실행 준비가 되었다면 '**저장(Save)**'버튼 클릭하고 '**테스트(Test)**'를 클릭하여 '**수동(Manually)**'으로 테스트합니다.
![image](https://github.com/user-attachments/assets/9451c636-ff11-4482-aa4c-0b35897b53c2)
